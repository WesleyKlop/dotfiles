{{- $data := . }}
{{- $email := get . "email" -}}
{{- if not $email -}}
    {{- $email = promptString "email" -}}
{{- end -}}

{{- $_ := set $data "github" (default (dict) (get $data "github")) -}}
{{- $_ := set $data "storage" (default (dict) (get $data "storage")) -}}
{{- $_ := set $data "toolchains" (default (dict) (get $data "toolchains")) -}}


{{- $github := list "name" "token" }}
{{- $toolchains := list "php" "deno" "node" "rust" "java" "elixir" "go" "kubernetes" }}
{{- $storage := list "postgres" "sqlite" "mysql" }}


{{- $personal := false -}}
{{- $work := false -}}
{{- $isWsl := false -}}
{{- if eq .chezmoi.os "linux" -}}
{{-    if .chezmoi.kernel.osrelease | lower | contains "microsoft" -}}
{{-       $isWsl = true -}}
{{-    end -}}
{{- end -}}
{{- if eq .chezmoi.hostname "KLOPWLT01" -}}
{{-    $work = true -}}
{{- end -}}

encryption = "gpg"
remove = true

[data]
    email = {{ $email | quote }}
    personal = {{ $personal }}
    work = {{ $work }}
    wsl = {{ $isWsl }}
[data.name]
    full = "Wesley Klop"
    first = "Wesley"
    last = "Klop"
[data.github]
{{- range $github }}
    {{- if not (hasKey $data.github .) }}
        {{- $_ := set $data.github . (promptString .) }}
    {{- end }}
    {{ . }} = {{ get $data.github . | quote }}
{{- end }}
[data.toolchains]
{{- range $toolchains }}
    {{- if not (hasKey $data.toolchains .) }}
        {{- $_ := set $data.toolchains . (promptBool .) }}
    {{- end }}
    {{ . }} = {{ get $data.toolchains . }}
{{- end }}
[data.storage]
{{- range $storage }}
    {{- if not (hasKey $data.storage .) }}
        {{- $_ := set $data.storage . (promptBool .) }}
    {{- end }}
    {{ . }} = {{ get $data.storage . }}
{{- end }}
[data.automation]
    update = false
[secret]
    command = "op"
[git]
    autoAdd = true
    autoCommit = false
[gpg]
    recipient = {{ $email | quote }}
